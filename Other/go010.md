# GO010

## stringer

Go官方提供的stringer工具可以用于创建获取枚举名的方法，首先获取stringer工具

```go
go get golang.org/x/tools/cmd/stringer
```

然后在需要创建的文件目录执行：

```bash
stringer -type=ENUMS
```



## Convert

```go
// string to int
i, _ := strconv.Atoi("123")
// int to string
t := strconv.Itoa(123)
```



## Sleep random

```go
rand.Seed(time.Now().UnixNano())
n := rand.Intn(10) // n will be between 0 and 10
time.Sleep(time.Duration(n)*time.Second)
```



## http下载文件

```go
url := "http://www.4399.com/test.txt"

resp, _ := http.Get(url)
defer resp.Body.Close()

data, _ := ioutil.ReadAll(resp.Body)
_, _ = os.Create("./test.png")
_ = ioutil.WriteFile("./test.png", data, 0777)
```



## 去重

```go
eMap := make(map[int32]MyStruct, length)
var result []*string
for _, v := range list {
  if _, ok := eMap[v.Id]; ok {
    continue
  }
  eMap[v.Id] = v
  result = append(result, v)
}
```



## SQL

```sql
select count(distinct r.id) from role r;
```



## JsonMap

go转json动态map

```go
func TestMap(t *testing.T) {
	m := make(map[int32]string, 10)
	m[1] = "a"
	m[2] = "b"
	m[3] = "c"

	j, err := json.Marshal(m)
	if err != nil {
		t.Error(err)
	}
	t.Log(string(j))
}
```

```go
func TestJson(t *testing.T) {
	//str := `{'1':'a','2':'b','3':'c'}`
	str := `{"1":"a","2":"b","3":"c"}`
	var m map[int32]string

	err := json.Unmarshal([]byte(str), &m)
	if err != nil {
		t.Error(err)
	}

	t.Log(m)
}
```

